Для анализа количества переходов по ссылкам используем Kafka и какой-нибудь
NoSQL (Redis, ClickHouse etc). Kafka, судя по документации, может собирать
пакеты и отправлять их дальше на обработку либо по достижению отпределённого
размера пакета, либо раз в какое-то время. Возможно можно использовать обе
эти настройки (если они не взаимоисключающие; чтобы сказать наверняка надо
изучить документацию по этому повросу). Этим и воспользуемся. При переходе
по ссылке отправляем сообщению в Кафку. По достижении настроенного лимита
Кафка отправляет пакет на обработку (чтобы не обрабатывать каждый клик по
ссылке и не нагружать БД аналитики запросами, учитывая нагрузку в 5.000
rps). Выгружаем данные из БД аналитики по запросу.
Если вариант с брокером не сработает, можно попробовать отправлять запрос
в Redis напрямую перед редиректом пользователя. По результатам анализа
производительности Redis выдерживает нагрузку

```
SET: 72202.16 requests per second
GET: 94607.38 requests per second
INCR: 84961.77 requests per second
LPUSH: 78988.94 requests per second
RPUSH: 88652.48 requests per second
LPOP: 87950.75 requests per second
RPOP: 80971.66 requests per second
SADD: 80192.46 requests per second
HSET: 84317.03 requests per second
SPOP: 78125.00 requests per second
```
